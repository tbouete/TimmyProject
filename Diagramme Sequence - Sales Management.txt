@startuml

title "Sequence Diagram : Sales management"

alt Signing sales agreement

    Person -> SalesAgreement : new SalesAgreement SA(prop, commissionAgency, sellingFees, priceToPaid, salesDate)
    Property -> SalesMandate : setSaleState(true)
    Person -> Person : listSalesAgreement.add(SA)
    Person -> SalesAgreement : giveMoney(SA.give10Percent())

end

alt Selling property

    RealEstateAgency -> Person : transferProperty(buyer, seller)
    RealEstateAgency -> Visit : new Visit visBuyer(buyer, dateOfVisit, transferDescription)
    RealEstateAgency -> Visit : new Visit visSeller(seller, dateOfVisit, transferDescription)
    RealEstateAgency -> RealEstateAgency : listVisit.add(visitBuyer)
    RealEstateAgency -> RealEstateAgency : listVisit.add(visitSeller)
    
    alt Seller
        Property -> Person : getSaleMandate()
        Person -> Person : removePropertyFromSale(prop)
        Person -> Person : listSalesMandate.remove(SM)
    end
    alt Buyer
        Person -> Person : buyProperty(SA)
        Property -> Property : setSaleMandate(null)
        Person -> SalesAgreement : giveMoney(SA.PayAll())
        SalesAgreement -> SalesAgreement : setSaleState(true)
    end
    
    Notary -> Notary : setMoneyState(moneyToBeTransferred)
    Notary -> RealEstateAgency : payBackAgency()
    Notary -> Notary : setMoneyState(moenyTransferred)

end 

@enduml